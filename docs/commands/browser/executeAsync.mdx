# executeAsync

## Обзор {#overview}

Используйте команду `executeAsync`, чтобы выполнить _асинхронно_ указанный JavaScript-код на странице текущего выбранного фрейма.

Последним аргументом команды должен быть колбэк, который будет вызван, как только скрипт завершит свою работу. В качестве входного параметра команда передает в колбэк результат выполнения скрипта.

Аргумент `script` определяет сценарий для выполнения в виде тела функции. Функция будет вызвана с предоставленным массивом `args`, и доступ к значениям может быть получен через объект `arguments` в указанном порядке. Последним аргументом всегда должна быть колбэк-функция, которая будет вызвана после того, как скрипт будет выполнен.

Аргументами могут быть любые JSON-примитивы, массивы или объекты JSON. Объекты JSON, которые определяют ссылку на _WebElement,_ будут преобразованы в соответствующий элемент DOM. Аналогично, любые _WebElements_ в результате скрипта будут возвращены клиенту в виде объектов _WebElement JSON_.

## Использование {#usage}

```javascript
await browser.executeAsync(script, arguments);
```

## Параметры команды {#parameters}

<table>
<thead>
<tr><td>**Имя**</td><td>**Тип**</td><td>**Описание**</td></tr>
</thead>
<tbody>
<tr><td>script</td><td>String или Function</td><td>Скрипт, который необходимо выполнить.</td></tr>
<tr><td>arguments</td><td>Any</td><td>Аргументы для скрипта. Последним аргументом должна быть колбэк-функция, которая будет вызвана после того, как скрипт будет выполнен.</td></tr>

</tbody>
</table>

## Примеры использования {#examples}

```javascript
it("should execute async JavaScript on the page", async ({ browser }) => {
    await browser.setTimeout({ script: 5000 });

    const result = await browser.executeAsync(
        function (a, b, c, d, done) {
            // здесь мы в browser-контексте: доступа к консоли и к клиенту у нас нет
            setTimeout(() => {
                done(a + b + c + d);
            }, 3000);
        },
        1,
        2,
        3,
        4,
    );

    // здесь мы в node.js-контексте: доступ к консоли и к клиенту у нас есть
    console.log(result); // выведет: 10
});
```

## Связанные команды {#related}

-   [execute](./execute)
-   [setTimeout](./setTimeout)
